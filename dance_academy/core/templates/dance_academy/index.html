<!DOCTYPE html>
{% extends 'dance_academy/base.html' %} 
{%block bodyblock %}
 {% load static %}

 <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
 <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
 <!------ Include the above in your HEAD tag ---------->
 
 <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
 <script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
 <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>

<style>

*[role="form"] {
    max-width: 1000px;
    padding: 50px;
    padding-right:50px;
    margin: 0 auto;
    border-radius: 0.3em;
    background-color: #f2f2f2;
}

*[role="form"] h2 { 
    font-family: 'Open Sans' , sans-serif;
    font-size: 40px;
    font-weight: 600;
    color: #000000;
    margin: 5% 0 5% 0;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 4px;
}


 </style>
<body>
  
    {% include "dance_academy/navbar.html" %}


        <div class="container">
            <form autocomplete="off" action="" method="post" id="student_registration_form" class="form-horizontal need-validation" role="form">
                {% csrf_token %}
                <h2>Student Registration</h2>
                <div class="form-group">
                    <label for="firstName" class="col-sm-3 control-label">First Name</label>
                    <div class="col-sm-9">
                        <input type="text" id="firstName" name="firstName" placeholder="First Name" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="lastName" class="col-sm-3 control-label">Last Name</label>
                    <div class="col-sm-9">
                        <input type="text" id="lastName" name="lastName" placeholder="Last Name" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="birthDate" class="col-sm-3 control-label">Date of Birth</label>
                    <div class="col-sm-9">
                        <input type="date" id="birthDate" name="birthDate" class="form-control" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="control-label col-sm-3">Gender</label>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-4">
                                <label class="radio-inline">
                                    <input type="radio" id="femaleRadio" name="gender" value="1" required>Female
                                </label>
                            </div>
                            <div class="col-sm-4">
                                <label class="radio-inline">
                                    <input type="radio" id="maleRadio" name="gender" value="0" required>Male
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="phoneNumber" class="col-sm-3 control-label">Phone Number</label>
                    <div class="col-sm-9">
                        <input type="text" id="phoneNumber" name="phoneNumber" placeholder="Phone Number" class="form-control" required>
                        <!-- <span class="help-block">Your phone number won't be disclosed anywhere </span> -->
                    </div>
                </div>

                <div class="form-group">
                    <label for="guardianName" class="col-sm-3 control-label">Guardian name</label>
                    <div class="col-sm-9">
                        <input type="text" id="guardianName" name="guardianName" placeholder="Guardian Name" class="form-control" required>
                    </div>
                </div>
               
                <div class="form-group">
                    <label for="guardianNo" class="col-sm-3 control-label">Guardian Contact </label>
                    <div class="col-sm-9">
                        <input type="text" id="guardianNo" name="guardianNo" placeholder="Guardian Contact Number" class="form-control" required>
                    </div>
                </div>


                <div class="form-group">
                    <label for="danceStyle" class="col-sm-3 control-label">Dance Style </label>
                    <div class="col-sm-9">
                        <input class="form-control"  name="danceStyle" id="danceStyle" required>
                       
                    
                    </div>
                </div>



                <div class="form-group">
                    <label for="batch" class="col-sm-3 control-label">Batch </label>
                    <div class="col-sm-9">
                        <select class="form-select" name="batch" id="batch" required>
                            {% for index, value in class_obj.batch_list %}
                            <option value={{index}}>{{value}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="timing" class="col-sm-3 control-label">Timing </label>
                    <div class="col-sm-9">                        
                        <select class="form-select" name="timing" id="timing" required>
                            {% for index, value in class_obj.timing_list %}
                            <option value={{index}}>{{value}}</option>
                            {% endfor %}
                        </select>

                    </div>
                </div>

                <div class="form-group">
                    <label for="medical_problem" class="col-sm-3 control-label">Any Medical Problem </label>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-4">
                                <label class="radio-inline">
                                    <input type="radio" id="medicalProblem" name="medicalProblem" value="1" required>Yes </label>
                            </div>
                            <div class="col-sm-4">
                                <label class="radio-inline">
                                    <input type="radio" id="medicalProblem" name="medicalProblem" value="0" required>No
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="medicalFitnessCertificate" class="col-sm-3 control-label">Medical Certificate(If any medical condition) </label>
                    <div class="col-sm-9">
                        <input class="form-control" type="file" name="medicalFitnessCertificate" id="medicalFitnessCertificate">
                    </div>
                </div>

                <div class="form-group">
                    <label for="id_type" class="col-sm-3 control-label">Identity Proof</label>
                        <div class="row">
                            <div class="col-sm-4">
                                <select class="form-select" name="id_type" id="id_type">
                                    {% for index, value in class_obj.id_type %}
                                    <option value={{index}}>{{value}}</option>
                                    {% endfor %}
                                </select>        
                            </div>
                            <div class="col-sm-8">
                                <input class="form-control" type="file" name="id_document" id="id_document">
                            </div>
                    </div>
                </div>


                <div class="form-group">
                    <label for="studentPhoto" class="col-sm-3 control-label">Student Photo </label>
                    <div class="col-sm-9">
                        <input class="form-control" type="file" name="studentPhoto" id="studentPhoto" accept="image/*">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary btn-block">Register</button>
            </form> <!-- /form -->
        </div> <!-- ./container -->
  
</body>

<script type="text/javascript">

    $(document).on('submit','#student_registration_form',function(e){    
        e.preventDefault();
        var form = document.getElementById("student_registration_form");
        var formData = new FormData(form);
        $.ajax({
            type:'POST',
            url: "{% url 'dance-academy:student_registration_request' %}",
            data:formData,
            processData: false,
            contentType: false,
            // data:{    
            //     fname:$('#firstName').val(),
            //     lname:$('#lastName').val(),
            //     dob:$('#birthDate').val(),
            //     phone:$('#phoneNumber').val(),
            //     gender:$('input:radio[name=gender]:checked').val(),
            //     guardianName:$('#guardianName').val(),
            //     guardianNo:$('#guardianNo').val(),
            //     danceStyle:$('#danceStyle').val(),
            //     batch:$('#batch').val(),  
            //     timing:$('#timing').val(),  
            //     medicalProblem:$('input:radio[name=medicalProblem]:checked').val(),
            //     medicalFitnessCertificate:$('#medicalFitnessCertificate').val(),   
            //     id_type:$('#id_type').val(), 
            //     id_document:$('#id_document').val(), 
            //     csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
    
            // },
            success : function(json){
                $('#firstName').val('');
                $('#lastName').val('');
                $('#birthDate').val('');
                $('#phoneNumber').val('');
                $('input[name="gender"]:selected').val('');
                $('#guardianName').val('');
                $('#guardianNo').val('');
                $('#danceStyle').val('');
                $('#batch').val('');
                $('#timing').val('');  
                $('input[name="medicalProblem"]:selected').val('');
                $('#medicalFitnessCertificate').val('');
                $('#id_type').val('');
                $('#id_document').val(''); 
                $('#studentPhoto').val(''); 
                $(window).scrollTop(0);
  
            if(json.success=="False"){
                $('#student_registration_form').prepend("<div class='alert alert-danger' style='left:0;top:0;width:100%; z-index:2;'>"+json.result+"</div>");
                $('.alert').delay(8000).fadeOut();
                }
                else{
                    $('#student_registration_form').prepend("<div class='alert alert-success' style='left:0;top:0;width:100%;  z-index:2;'>"+json.result+"</div>");
                    $('.alert').delay(8000).fadeOut();
                } 
    
            },
            error : function(xhr,errmsg,err) {
                $('#student_registration_form').prepend("<div class='alert alert-danger' style='top:0;left:0;width:100%;'>"+err+"</div>"); // add the error to the dom
                $('.alert').delay(8000).fadeOut();
                $(window).scrollTop(0);
                //console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
            }
        });
    });
     </script>
  
{%endblock bodyblock %}